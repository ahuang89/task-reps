<!DOCTYPE html>
<html>
  <head>
    <title>My experiment</title>
    <script src="https://unpkg.com/jspsych@8.2.1"></script>
    <script src="https://unpkg.com/@jspsych/plugin-html-keyboard-response@2.1.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-instructions@1.1.4"></script>
    <script src="https://unpkg.com/@jspsych/plugin-survey-multi-choice@1.1.3"></script>
    <script src="https://unpkg.com/@jspsych/plugin-html-button-response@2.1.0"></script>
    <link href="./jspsych.css" rel="stylesheet" type="text/css" />
  </head>
  <body></body>
  <script>
    // variable to initialize jsPsych//
    var jsPsych = initJsPsych();

    //create timeline//
    var timeline = [];

    //define welcome message//
    var welcome = {
      type: jsPsychInstructions,
      pages: [
        `<p>Welcome to the experiment. Click below to continue.</p>`
      ],
      show_clickable_nav: true
    };
    timeline.push(welcome);

    //tile activation instructions//
    var tile_intro = {
        type:jsPsychInstructions,
        pages: [
        //intro//
        `<p>We are designing games that scientists can use to study visual attention.</p>
        <p>Our goal is to make the games as immersive and engaging as possible.<br>
        To do so, we are getting feedback from people like you.</p>`,

        //description//
        `<p>You'll be playing a game where you'll be competing for a chance to win a <strong>$100.00 bonus prize</strong>.</p>
        <p>Specifically, during the game, you'll earn tokens. The tokens you earn will be entered into a lottery, 
        and if one of your tokens is drawn, you'll win $100.00.<br>The more tokens you earn, the more likely you'll be to win $100.00.</p>`,

        //instructions 1//
        `<p>The game you'll play involves activating a gray tile, like this:</p>
        <div class="outcome-container">
            <div class="gray-tile"></div>
        </div>
        <p>The tile will appear on your screen, then quickly disappear. To activate it, you must press your SPACEBAR before it disappears;
        whenever you see the tile, you should press your SPACEBAR as fast as possible.</p>`,

        //instructions 2//
        `<p>If you activate the tile, it'll turn blue:</p>
        <div class="outcome-container">
            <div class="blue-tile"></div>
        </div>`,

        //instructions 3//
        `<p>If you fail to activate the tile, it'll disappear:</p>
        <div class="outcome-container">
        </div>`,

        //instructions 4//
        `<p>To get a feel for activating the tile, you'll complete a practice session.</p>
        <p>During the practice session, you'll have 10 attempts to activate a tile.</p>
        <p>Once you proceed, the practice session will start, so get ready to press your SPACEBAR.</p>`,
      
        ],
        show_clickable_nav: true
    };
    timeline.push(tile_intro);
    
    




    // Insert tile PRACTICE game //







    var games = {
        type:jsPsychInstructions,
        pages: [
        //intro games//
        `<p>You'll play one of three different games. All three games yield the same expected number of tokens. That means, on average, no game is more rewarding than the others—the only difference lies in the rules. The games are:</p>
            <div class="heading">
                <p>1. One-Click Wonder</p>
                <p>2. Streak-O-Rama</p>
                <p>3. Six Shooter</p>
            </div>
        <p>You'll learn the rules of each game on the following pages.</p>`,

        //binary 1//
        `<div class="game-header">One-Click Wonder: Rules</div>
        <div class="outcome-container">
            <p>In <strong>One-Click Wonder</strong>, the goal is to activate each individual tile.</p>
            <p>Each time you activate the tile you get +10 tokens.</p>
            <p>Each time you miss the tile you get +0 tokens.</p>
        </div>`,

        //binary 2//
        `<div class ="game-header">One-Click Wonder: Rules</div>
        <p>Each time you activate the tile you'll see this message:</p>
        <div class ="outcome-container">
            <div class ="win-text">+10 tokens</div>
        </div>`,

        //binary 3//
        `<div class ="game-header">One-Click Wonder: Rules</div>
        <p>Each time you miss the tile you'll see this message:</p>
        <div class ="outcome-container">
            <div class ="lose-text">+0 tokens</div>
        </div>`,

        //divider//
        `<p>Continue to learn the rules of <strong>Streak-O-Rama</strong>.</p>`,


        //streak 1//
        `<div class="game-header">Streak-O-Rama: Rules</div>
        <div class="outcome-container">
            <p>In <strong>Streak-O-Rama</strong>, the goal is to build streaks of consecutive tile activations.</p>
            <p>For each consecutive tile you activate, you get +10 tokens.</p>
        </div>`,

        //streak 2//
        `<div class ="game-header">Streak-O-Rama: Rules</div>
        <p>After each activation, you’ll see the length of your current streak.</p>
        <p>For instance, if you’ve activated the tile 3 times in a row, you'll see this message:</p>
        <div class ="outcome-container">
            <div class="status-text">Streak: 3</div>
        </div>`,

        //streak 3//
        `<div class ="game-header">Streak-O-Rama: Rules</div>
        <p>Each time a streak ends, you'll see how many tokens you earned.</p>
        <p>For instance, if you miss the tile after activating 3 consecutive tiles, you'll see this message indicating that you earned 30 tokens:</p>
        <div class ="outcome-container">
            <div class="status-text">Final streak: 3</div>
            <div class="win-text">+30 tokens</div>
        </div>`,

        //streak 4//
        `<div class ="game-header">Streak-O-Rama: Rules</div>
        <p>If you miss the tile after after activating 1 tile, you'll see this message indicating that<br>you earned 10 tokens:</p>
        <div class ="outcome-container">
            <div class="status-text">Final streak: 1</div>
            <div class="win-text">+10 tokens</div>
        </div>`,

        //streak 5//
        `<div class ="game-header">Streak-O-Rama: Rules</div>
        <p>If you miss the tile after activating no tiles, you'll see this message indicating that<br>you earned 0 tokens:</p>
        <div class ="outcome-container">
            <div class="status-text">Final streak: 0</div>
            <div class="lose-text">+0 tokens</div>
        </div>`,

        //divider//
        `<p>Continue to learn the rules of <strong>Six Shooter</strong>.</p>`,



        //one in six 1//
        `<div class="game-header">Six Shooter: Rules</div>
        <div class="outcome-container">
            <p><strong>Six Shooter</strong> is divided into rounds of up to 6 attempts. The goal is to win rounds.
            <p>To win a round, you must activate the tile with 6 attempts. For each round you win, you earn +10 tokens.</p>
        </div>`,

        //one in six 2//
        `<div class ="game-header">Six Shooter Rules</div>
        <p>Each time you miss the tile before the round ends, you'll see how many attempts are remaining. For example, after 2 misses, you'll see this message indicating that you have 4 attempts remaining:</p>
        <div class ="outcome-container">
            <div class="status-text">Attempts remaining: 4</div>
        </div>`,

        //one in six 3//
        `<div class ="game-header">Six Shooter Rules</div>
        <p>If you activate the tile before the round ends, you'll see this message<br>indicating you won the round:</p>
        <div class ="outcome-container">
            <div class="win-text">+10 tokens</div>
            <div class="status-text">Get ready for the next round!</div>
        </div>
        <p>As soon as you receive your tokens, the current round ends and the next one begins.</p>`,

        //one in six 4//
        `<div class ="game-header">Six Shooter: Rules</div>
        <p>If you miss the tile 6 consecutive times, you'll see this message indicating you lost the round:</p>
        <div class ="outcome-container">
            <div class="status-text-red">Attempts remaining: 0</div>
            <div class="lose-text">+0 tokens</div>
            <div class="status-text">Get ready for the next round!</div>
        </div>`,

        ],
        show_clickable_nav: true
    };
    timeline.push(games);


    //quiz on representations//

    // Define correct answers
    var correct_answers = {
        'bonus-question': 'Earn as many tokens as possible.',
        'one-click-wonder': 'By activating each individual tile.',
        'streak-o-rama': 'By building streaks.',
        'six-shooter': 'By winning rounds of 6 attempts.',
        'token-earning': 'On average, no game is worth more tokens than the others'
    };

    // Quiz trial with all questions on one page
    var quiz_trial = {
        type: jsPsychSurveyMultiChoice,
        preamble: '<div class="quiz-instructions">' +
                 '<p>Please answer the following questions to ensure you understand the three games.</p>' +
                 '</div>',
        questions: [
            {
                prompt: "What must you do to maximize your odds of winning a $100.00 bonus?",
                name: 'bonus-question',
                options: [
                    'Earn as many tokens as possible.',
                    'Finish the game as quickly as possible.'
                ],
                required: true
            },
            {
                prompt: "How do you earn tokens in <span class='game-name'>One-Click Wonder</span>?",
                name: 'one-click-wonder',
                options: [
                    'By activating each individual tile.',
                    'By building streaks.',
                    'By winning rounds of 6 attempts.'
                ],
                required: true
            },
            {
                prompt: "How do you earn tokens in <span class='game-name'>Streak-O-Rama</span>?",
                name: 'streak-o-rama',
                options: [
                    'By activating each individual tile.',
                    'By building streaks.',
                    'By winning rounds of 6 attempts.'
                ],
                required: true
            },
            {
                prompt: "How do you earn tokens in <span class='game-name'>Six Shooter</span>?",
                name: 'six-shooter',
                options: [
                    'By activating each individual tile.',
                    'By building streaks.',
                    'By winning rounds of 6 attempts.'
                ],
                required: true
            },
            {
                prompt: "Which game, on average, would earn the most tokens?",
                name: 'token-earning',
                options: [
                    'One-Click Wonder',
                    'Streak-O-Rama',
                    'Six Shooter',
                    'On average, no game is worth more tokens than the others'
                ],
                required: true
            }
        ],
        button_label: 'Submit Answers',
        on_finish: function(data) {
            // Check answers
            var responses = data.response;
            var all_correct = true;
            var incorrect_count = 0;
            
            for (var question in correct_answers) {
                if (responses[question] !== correct_answers[question]) {
                    all_correct = false;
                    incorrect_count++;
                }
            }
            
            // Store results in data
            data.all_correct = all_correct;
            data.incorrect_count = incorrect_count;
            data.total_questions = Object.keys(correct_answers).length;
        }
    };

    // Feedback trial that shows results and loops if needed
    var feedback_trial = {
        type: jsPsychSurveyMultiChoice,
        preamble: function() {
            var last_trial_data = jsPsych.data.get().last(1).values()[0];
            
            if (last_trial_data.all_correct) {
                return '<div class="feedback correct-feedback">' +
                       'All answers correct! You may now proceed to the games.' +
                       '</div>' +
                       '<div class="quiz-instructions">' +
                       '<p>Please answer the following questions to ensure you understand the three games.</p>' +
                       '</div>';
            } else {
                var correct_count = last_trial_data.total_questions - last_trial_data.incorrect_count;
                return '<div class="feedback incorrect-feedback">' +
                       'You got ' + correct_count + ' out of ' + last_trial_data.total_questions + ' questions correct. ' +
                       'Please answer all questions correctly to proceed.' +
                       '</div>' +
                       '<div class="quiz-instructions">' +
                       '<p>Please answer the following questions to ensure you understand all three games.</p>' +
                       '</div>';
            }
        },
        questions: [
            {
                prompt: "What must you do to maximize your odds of winning a $100.00 bonus?",
                name: 'bonus-question',
                options: [
                    'Earn as many tokens as possible.',
                    'Finish the game as quickly as possible.'
                ],
                required: true
            },
            {
                prompt: "How do you earn tokens in <span class='game-name'>One-Click Wonder</span>?",
                name: 'one-click-wonder',
                options: [
                    'By activating each individual tile.',
                    'By building streaks.',
                    'By winning rounds of 6 attempts.'
                ],
                required: true
            },
            {
                prompt: "How do you earn tokens in <span class='game-name'>Streak-O-Rama</span>?",
                name: 'streak-o-rama',
                options: [
                    'By activating each individual tile.',
                    'By building streaks.',
                    'By winning rounds of 6 attempts.'
                ],
                required: true
            },
            {
                prompt: "How do you earn tokens in <span class='game-name'>Six Shooter</span>?",
                name: 'six-shooter',
                options: [
                    'By activating each individual tile.',
                    'By building streaks.',
                    'By winning rounds of 6 attempts.'
                ],
                required: true
            },
            {
                prompt: "Which game, on average, would earn the most tokens?",
                name: 'token-earning',
                options: [
                    'One-Click Wonder',
                    'Streak-O-Rama',
                    'Six Shooter',
                    'On average, no game is worth more tokens than the others'
                ],
                required: true
            }
        ],
        button_label: 'Submit Answers',
        on_finish: function(data) {
            // Check answers
            var responses = data.response;
            var all_correct = true;
            var incorrect_count = 0;
            
            for (var question in correct_answers) {
                if (responses[question] !== correct_answers[question]) {
                    all_correct = false;
                    incorrect_count++;
                }
            }
            
            // Store results in data
            data.all_correct = all_correct;
            data.incorrect_count = incorrect_count;
            data.total_questions = Object.keys(correct_answers).length;
        }
    };

    // Quiz loop - repeats until all answers are correct
    var quiz_loop = {
        timeline: [quiz_trial],
        loop_function: function(data) {
            var last_trial = data.values().slice(-1)[0];
            if (!last_trial.all_correct) {
                // Replace the trial with feedback version for next iteration
                quiz_loop.timeline = [feedback_trial];
                return true;
            }
            return false;
        }
    };
    timeline.push(quiz_loop);



    //pick a representation//
    
    var choose_rep = {
        type:jsPsychSurveyMultiChoice,
        questions: [
            {
                prompt: "Based on what you have learned, which game would you like to play?<br>The game will start on the next page.",
                name: "game-choice",
                options: ["One-Click Wonder", "Streak-O-Rama", "Six Shooter"],
                required: true

            }

        ],
    };
    timeline.push(choose_rep)








    //insert REAL game//







    //*start the experiment//
    jsPsych.run(timeline);

  </script>
</html>
